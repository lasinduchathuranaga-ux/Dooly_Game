<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Dolly's Teddy Games ğŸ»</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

:root {
  --blue:   #4a90d9;
  --purple: #b8b3e9;
  --pink:   #f9b4c4;
  --yellow: #ffe66d;
  --green:  #7ed6a0;
  --dark:   #3a2a5e;
  --card:   #fff5fb;
}

html, body {
  min-height: 100%;
  background: linear-gradient(160deg, #a8d8ea 0%, #c8b0f5 50%, #f9b4c4 100%);
  font-family: 'Nunito', sans-serif;
  overflow-x: hidden;
  color: var(--dark);
}

/* â”€â”€â”€ FLOATING HEARTS â”€â”€â”€ */
.hbg { position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden; }
.hf  { position:absolute; animation:floatUp linear infinite; opacity:.4; }
@keyframes floatUp {
  0%   { transform:translateY(105vh) rotate(0deg);  opacity:.45; }
  100% { transform:translateY(-15vh) rotate(30deg); opacity:0;   }
}

/* â”€â”€â”€ PAGE LAYOUT â”€â”€â”€ */
.page {
  position:relative; z-index:1;
  padding: 18px 12px 50px;
  display:flex; flex-direction:column; align-items:center; gap:22px;
}

/* â”€â”€â”€ HEADER â”€â”€â”€ */
.header {
  text-align:center;
  animation: popIn .7s cubic-bezier(.34,1.56,.64,1) both;
}
.header h1 {
  font-family:'Pacifico',cursive; font-size:2rem;
  background:linear-gradient(90deg,#4a90d9,#c47bc0,#f06292,#4a90d9);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text; background-size:200%;
  animation:shimmer 3s linear infinite;
}
@keyframes shimmer{0%{background-position:0%}100%{background-position:200%}}
.header p { font-size:.85rem; color:#8050b0; font-weight:700; margin-top:4px; }

/* â”€â”€â”€ SOUND UNLOCK â”€â”€â”€ */
#soundHint {
  background:#fff0fa; border:2px dashed var(--pink);
  border-radius:14px; padding:8px 16px;
  font-size:.82rem; color:#b050a0; font-weight:800;
  cursor:pointer; text-align:center;
  animation:pulse 1.5s ease-in-out infinite;
  width:100%; max-width:380px;
}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}

/* â”€â”€â”€ SCORE BAR â”€â”€â”€ */
.scorebar {
  display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
  width:100%; max-width:380px;
}
.score-pill {
  background:white; border-radius:50px; padding:6px 18px;
  font-weight:800; font-size:.85rem; color:var(--dark);
  box-shadow:0 3px 12px rgba(160,80,160,.18);
  display:flex; align-items:center; gap:5px;
}

/* â”€â”€â”€ GAME CARD â”€â”€â”€ */
.game-card {
  background:var(--card);
  border-radius:28px; padding:22px 18px 24px;
  width:100%; max-width:380px;
  box-shadow:0 16px 50px rgba(160,80,140,.2),
             0 0 0 3px var(--pink), 0 0 0 6px var(--purple);
  animation: popIn .6s cubic-bezier(.34,1.56,.64,1) both;
  position:relative; overflow:hidden;
}
.game-card:nth-child(2){ animation-delay:.1s; }
.game-card:nth-child(3){ animation-delay:.2s; }
@keyframes popIn{
  from{transform:scale(.6) rotate(-3deg);opacity:0}
  to  {transform:scale(1)  rotate(0deg);opacity:1}
}

.game-title {
  font-family:'Pacifico',cursive; font-size:1.25rem;
  color:#c0456a; margin-bottom:4px; text-align:center;
}
.game-subtitle {
  font-size:.78rem; color:#8a70a0; font-weight:700;
  text-align:center; margin-bottom:14px;
}

/* â”€â”€â”€ TIMER â”€â”€â”€ */
.timer-ring-wrap { display:flex; justify-content:center; margin-bottom:10px; }
.timer-ring { position:relative; width:80px; height:80px; }
.timer-ring svg { transform:rotate(-90deg); }
.timer-ring circle { fill:none; stroke-width:7; }
.timer-bg  { stroke:#f0e0f5; }
.timer-arc { stroke:var(--purple); stroke-linecap:round;
             transition:stroke-dashoffset .9s linear, stroke .3s; }
.timer-text {
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  font-family:'Pacifico',cursive; font-size:1.4rem; color:var(--dark);
}

/* â”€â”€â”€ GAME 1 BEARS GRID â”€â”€â”€ */
.bears-grid {
  display:grid; grid-template-columns:repeat(3,1fr); gap:10px;
  margin-bottom:12px;
}
.bear-option {
  display:flex; flex-direction:column; align-items:center;
  background:white; border-radius:18px; padding:8px 4px 6px;
  cursor:pointer; border:3px solid transparent;
  box-shadow:0 3px 12px rgba(160,80,140,.12);
  transition:all .2s;
  user-select:none;
}
.bear-option:hover, .bear-option:active { transform:scale(1.06); }
.bear-option.correct  { border-color:#7ed6a0; background:#f0fff6; animation:correctPop .4s cubic-bezier(.34,1.56,.64,1); }
.bear-option.wrong    { border-color:#ff8888; background:#fff0f0; animation:shake .4s ease; }
.bear-option.disabled { pointer-events:none; opacity:.55; }
@keyframes correctPop{ from{transform:scale(.8)} to{transform:scale(1)} }
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

.bear-label { font-size:.72rem; font-weight:800; color:var(--dark); margin-top:4px; }

/* instruction */
.instruction {
  text-align:center; padding:10px 14px; border-radius:14px;
  background:linear-gradient(135deg,rgba(168,216,234,.3),rgba(184,179,233,.3));
  border:2px dashed var(--pink); font-size:.85rem; color:#6a5a8e; font-weight:700;
  margin-bottom:12px;
}
.instruction span { color:#c0456a; font-size:.95rem; }

/* btn */
.btn {
  width:100%; border:none; border-radius:50px; padding:12px;
  font-family:'Nunito',sans-serif; font-size:1rem; font-weight:900;
  color:white; cursor:pointer; transition:all .25s;
  box-shadow:0 4px 16px rgba(180,80,160,.28);
}
.btn:active{transform:scale(.96);}
.btn-pink   { background:linear-gradient(135deg,#f06292,#f9b4c4); }
.btn-purple { background:linear-gradient(135deg,#9c82e0,#b8b3e9); }
.btn-green  { background:linear-gradient(135deg,#5cb85c,#7ed6a0); }

/* result flash */
.result-msg {
  text-align:center; padding:12px 14px; border-radius:16px; margin-bottom:12px;
  font-size:.92rem; font-weight:800; display:none;
}
.result-msg.win  { background:#efffef; border:2px solid #7ed6a0; color:#2a8a2a; display:block; }
.result-msg.lose { background:#fff0f0; border:2px solid #ff8888; color:#aa2222; display:block; }

/* â”€â”€â”€ GAME 2 PUZZLE â”€â”€â”€ */
.puzzle-wrap {
  display:flex; flex-direction:column; align-items:center; gap:12px;
}
.puzzle-info { display:flex; gap:16px; justify-content:center; flex-wrap:wrap; margin-bottom:4px; }
.pinfo-pill {
  background:white; border-radius:50px; padding:5px 14px;
  font-weight:800; font-size:.8rem; color:var(--dark);
  box-shadow:0 2px 8px rgba(160,80,140,.12);
}

.puzzle-grid {
  display:grid;
  gap:3px;
  background:#d0b8e8;
  border-radius:14px;
  padding:3px;
  box-shadow:0 8px 28px rgba(160,80,140,.22);
  touch-action:none;
}
.puzzle-cell {
  width:100%; aspect-ratio:1;
  border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  font-size:1.6rem;
  cursor:pointer;
  transition:transform .15s, box-shadow .15s;
  user-select:none;
  position:relative;
  font-weight:900;
}
.puzzle-cell.filled {
  background:white;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.puzzle-cell.filled:active { transform:scale(.93); }
.puzzle-cell.empty {
  background:#e8d0f8;
  cursor:default;
}
.puzzle-cell.correct-pos { background:linear-gradient(135deg,#f0fff6,#d8f8e0); }
.piece-label {
  position:absolute; bottom:2px; right:3px;
  font-size:.52rem; font-weight:900; color:#c0a0d8; opacity:.7;
}

.puzzle-solved {
  display:none; text-align:center; padding:16px;
  background:linear-gradient(135deg,#f0fff6,#f5eeff);
  border:2px solid #7ed6a0; border-radius:18px;
}
.puzzle-solved.show { display:block; animation:popIn .5s cubic-bezier(.34,1.56,.64,1); }
.puzzle-solved h3 { font-family:'Pacifico',cursive; color:#2a8a2a; font-size:1.2rem; margin-bottom:6px; }
.puzzle-solved p  { font-size:.88rem; color:#6a5a8e; font-weight:700; }

/* confetti */
.confetti-piece {
  position:fixed; border-radius:2px;
  animation:cfall linear forwards; pointer-events:none; z-index:9999;
}
@keyframes cfall{
  0%  {transform:translateY(-20px) rotate(0deg);   opacity:1;}
  100%{transform:translateY(110vh) rotate(720deg); opacity:0;}
}

/* â”€â”€â”€ WIN OVERLAY â”€â”€â”€ */
.win-overlay {
  display:none; position:fixed; inset:0; z-index:9000;
  background:rgba(60,20,80,.6); backdrop-filter:blur(3px);
  align-items:center; justify-content:center;
}
.win-overlay.show { display:flex; }
.win-modal {
  background:var(--card); border-radius:28px; padding:30px 24px;
  text-align:center; max-width:320px; width:90%;
  box-shadow:0 20px 60px rgba(0,0,0,.3);
  animation:popIn .5s cubic-bezier(.34,1.56,.64,1);
}
.win-modal h2 { font-family:'Pacifico',cursive; font-size:1.5rem; color:#c0456a; margin-bottom:8px; }
.win-modal p  { font-size:.9rem; color:#6a5a8e; font-weight:700; line-height:1.7; }
.win-modal .star-row { font-size:1.8rem; margin:12px 0; }
</style>
</head>
<body>

<div class="hbg" id="hbg"></div>

<div class="page">

  <!-- HEADER -->
  <div class="header">
    <h1>ğŸ» Dolly's Games! ğŸ»</h1>
    <p>ğŸ’™ Blue Â· ğŸ’œ Purple Â· ğŸ’— Pink Â· Play & Win!</p>
  </div>

  <!-- Sound hint -->
  <div id="soundHint" onclick="unlockAudio()">ğŸ”Š Tap here first to enable sound on phone! ğŸ“±</div>

  <!-- Score bar -->
  <div class="scorebar">
    <div class="score-pill">â­ Score: <span id="totalScore">0</span></div>
    <div class="score-pill">ğŸ† Wins: <span id="totalWins">0</span></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="game-card">
    <div class="game-title">ğŸ® Game 1: Dress Dolly!</div>
    <div class="game-subtitle">Tap the correct dress color before time runs out!</div>

    <!-- Timer ring -->
    <div class="timer-ring-wrap">
      <div class="timer-ring">
        <svg width="80" height="80" viewBox="0 0 80 80">
          <circle class="timer-bg"  cx="40" cy="40" r="34"/>
          <circle class="timer-arc" id="timerArc" cx="40" cy="40" r="34"
                  stroke-dasharray="213.6" stroke-dashoffset="0"/>
        </svg>
        <div class="timer-text" id="timerText">15</div>
      </div>
    </div>

    <div class="instruction" id="g1Instruction">
      Press <span>Start Game</span> to play! ğŸ€
    </div>

    <div class="bears-grid" id="bearsGrid">
      <!-- generated by JS -->
    </div>

    <div class="result-msg" id="g1Result"></div>

    <button class="btn btn-pink" id="g1Btn" onclick="startGame1()">ğŸ® Start Game 1!</button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME 2 â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="game-card">
    <div class="game-title">ğŸ§© Game 2: Teddy Puzzle!</div>
    <div class="game-subtitle">Slide pieces to complete 10 Dolly teddies! ğŸ»</div>

    <div class="puzzle-info">
      <div class="pinfo-pill">ğŸ§© Moves: <span id="moveCount">0</span></div>
      <div class="pinfo-pill">â±ï¸ Time: <span id="puzzleTime">0</span>s</div>
      <div class="pinfo-pill">âœ… Done: <span id="piecesCorrect">0</span>/10</div>
    </div>

    <div class="puzzle-wrap">
      <div class="puzzle-grid" id="puzzleGrid"></div>
      <div class="puzzle-solved" id="puzzleSolved">
        <h3>ğŸ‰ Puzzle Complete!</h3>
        <p>Amazing Dolly! You solved the teddy puzzle!<br>You are so smart & beautiful! ğŸ’—ğŸ»</p>
      </div>
      <button class="btn btn-purple" onclick="initPuzzle()">ğŸ”€ Shuffle Puzzle</button>
    </div>
  </div>

</div>

<!-- Win overlay -->
<div class="win-overlay" id="winOverlay" onclick="closeWin()">
  <div class="win-modal" onclick="event.stopPropagation()">
    <h2 id="winTitle">ğŸ‰ You Win!</h2>
    <div class="star-row">â­â­â­</div>
    <p id="winMsg">Great job Dolly!</p>
    <br>
    <button class="btn btn-green" onclick="closeWin()">ğŸ€ Play Again!</button>
  </div>
</div>

<script>
// â•â• AUDIO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let audioCtx = null;
function initAudio() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === 'suspended') audioCtx.resume();
  return audioCtx;
}
['touchstart','touchend','click'].forEach(e => document.addEventListener(e, () => initAudio(), {once:true}));

function unlockAudio() {
  initAudio();
  playTone(440,'sine',.05,.01,0);
  const h = document.getElementById('soundHint');
  h.textContent = 'âœ… Sound enabled! Have fun! ğŸµ';
  h.style.background='#e8ffe8'; h.style.color='#2a8a2a'; h.style.border='2px dashed #6ac96a';
  h.style.animation='none';
  setTimeout(()=>h.style.display='none', 1800);
}

function playTone(freq, type, dur, vol, delay) {
  try {
    const ctx = initAudio();
    const play = () => {
      const o = ctx.createOscillator(), g = ctx.createGain();
      o.connect(g); g.connect(ctx.destination);
      o.type = type; o.frequency.value = freq;
      const t = ctx.currentTime + delay;
      g.gain.setValueAtTime(vol, t);
      g.gain.exponentialRampToValueAtTime(.001, t + dur);
      o.start(t); o.stop(t + dur + .05);
    };
    ctx.state === 'suspended' ? ctx.resume().then(play) : play();
  } catch(e){}
}

function playClick()   { playTone(660,'sine',.1,.22,0); playTone(880,'sine',.1,.15,.08); }
function playWrong()   { playTone(220,'sawtooth',.2,.2,0); playTone(180,'sawtooth',.25,.15,.1); }
function playWin()     {
  [[523,.12],[659,.12],[784,.12],[1047,.22],[784,.1],[1047,.1],[1175,.35]].reduce((t,[f,d])=>{ playTone(f,'sine',d,.3,t); return t+d+.04; },0);
  [[330,.12],[415,.12],[494,.12],[659,.22],[494,.1],[659,.1],[740,.35]].reduce((t,[f,d])=>{ playTone(f,'triangle',d,.15,t); return t+d+.04; },0);
}
function playTick()    { playTone(800,'square',.05,.08,0); }
function playSlide()   { playTone(440,'sine',.08,.15,0); playTone(550,'sine',.06,.1,.07); }
function playPuzzleWin(){ [[784,.15],[988,.15],[1175,.15],[1319,.3],[1175,.1],[1319,.1],[1568,.4]].reduce((t,[f,d])=>{ playTone(f,'sine',d,.3,t); return t+d+.04; },0); }

// â•â• SCORE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let totalScore = 0, totalWins = 0;
function addScore(pts) {
  totalScore += pts;
  totalWins += 1;
  document.getElementById('totalScore').textContent = totalScore;
  document.getElementById('totalWins').textContent = totalWins;
}

// â•â• CONFETTI â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CC = ['#f9b4c4','#b8b3e9','#4a90d9','#ffe66d','#f06292','#a8d8ea','#7ed6a0'];
function launchConfetti(n=50) {
  for(let i=0;i<n;i++) {
    setTimeout(()=>{
      const c=document.createElement('div');
      c.className='confetti-piece';
      c.style.left=Math.random()*100+'vw';
      c.style.top='-12px';
      c.style.background=CC[Math.floor(Math.random()*CC.length)];
      c.style.width=(8+Math.random()*10)+'px';
      c.style.height=(8+Math.random()*10)+'px';
      c.style.borderRadius=Math.random()>.5?'50%':'2px';
      c.style.animationDuration=(1.8+Math.random()*1.5)+'s';
      c.style.animationDelay=(Math.random()*.3)+'s';
      document.body.appendChild(c);
      setTimeout(()=>c.remove(),3500);
    },i*22);
  }
}

function showWinOverlay(title, msg) {
  document.getElementById('winTitle').textContent = title;
  document.getElementById('winMsg').textContent = msg;
  document.getElementById('winOverlay').classList.add('show');
  launchConfetti(70);
  playWin();
}
function closeWin() { document.getElementById('winOverlay').classList.remove('show'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GAME 1  â€“  Dress Dolly Timer Game
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DRESSES = [
  { id:'pink',   label:'ğŸ’— Pink',   color:'#f9b4c4', bowColor:'#4a90d9' },
  { id:'blue',   label:'ğŸ’™ Blue',   color:'#4a90d9', bowColor:'#f9b4c4' },
  { id:'purple', label:'ğŸ’œ Purple', color:'#b8b3e9', bowColor:'#f9b4c4' },
  { id:'yellow', label:'ğŸ’› Yellow', color:'#ffe66d', bowColor:'#f9b4c4' },
  { id:'green',  label:'ğŸ’š Green',  color:'#7ed6a0', bowColor:'#f9b4c4' },
  { id:'orange', label:'ğŸ§¡ Orange', color:'#ffb347', bowColor:'#4a90d9' },
];

let g1Timer=null, g1Time=15, g1Running=false, g1Target=null, g1Score=0, g1Round=0;
const TOTAL_TIME = 15;
const circumference = 2 * Math.PI * 34; // 213.6

function makeBearSVG(dressColor, bowColor) {
  return `<svg width="68" height="88" viewBox="0 0 160 200" xmlns="http://www.w3.org/2000/svg">
    <circle cx="42" cy="46" r="21" fill="#c9956a"/>
    <circle cx="118" cy="46" r="21" fill="#c9956a"/>
    <circle cx="42" cy="46" r="12" fill="#e8b48a"/>
    <circle cx="118" cy="46" r="12" fill="#e8b48a"/>
    <ellipse cx="80" cy="140" rx="48" ry="55" fill="#c9956a"/>
    <ellipse cx="80" cy="158" rx="46" ry="40" fill="${dressColor}"/>
    <ellipse cx="80" cy="150" rx="40" ry="18" fill="${dressColor}" opacity=".7"/>
    <ellipse cx="80" cy="195" rx="46" ry="9" fill="${dressColor}" opacity=".6"/>
    <ellipse cx="80" cy="130" rx="16" ry="7" fill="${bowColor}"/>
    <ellipse cx="70" cy="128" rx="12" ry="8" fill="${bowColor}" transform="rotate(-30 70 128)"/>
    <ellipse cx="90" cy="128" rx="12" ry="8" fill="${bowColor}" transform="rotate(30 90 128)"/>
    <circle cx="80" cy="130" r="5" fill="${bowColor}" opacity=".7"/>
    <circle cx="80" cy="74" r="42" fill="#c9956a"/>
    <circle cx="80" cy="82" r="20" fill="#e8b48a"/>
    <circle cx="65" cy="65" r="7" fill="#2d1a0e"/>
    <circle cx="95" cy="65" r="7" fill="#2d1a0e"/>
    <circle cx="63" cy="63" r="2.5" fill="white"/>
    <circle cx="93" cy="63" r="2.5" fill="white"/>
    <ellipse cx="80" cy="80" rx="8" ry="5" fill="#2d1a0e"/>
    <ellipse cx="80" cy="79" rx="4" ry="2" fill="#ff6b9d"/>
    <path d="M 68 89 Q 80 101 92 89" stroke="#2d1a0e" stroke-width="2.5" fill="none" stroke-linecap="round"/>
    <circle cx="54" cy="79" r="10" fill="#f9b4c4" opacity=".45"/>
    <circle cx="106" cy="79" r="10" fill="#f9b4c4" opacity=".45"/>
    <ellipse cx="28" cy="128" rx="14" ry="29" fill="#c9956a" transform="rotate(18 28 128)"/>
    <ellipse cx="132" cy="128" rx="14" ry="29" fill="#c9956a" transform="rotate(-18 132 128)"/>
    <circle cx="22" cy="150" r="12" fill="#c9956a"/>
    <circle cx="138" cy="150" r="12" fill="#c9956a"/>
    <ellipse cx="60" cy="193" rx="15" ry="12" fill="#b8845a"/>
    <ellipse cx="100" cy="193" rx="15" ry="12" fill="#b8845a"/>
  </svg>`;
}

function shuffle(arr) { return [...arr].sort(()=>Math.random()-.5); }

function startGame1() {
  clearInterval(g1Timer);
  g1Running = true; g1Round++;
  g1Time = TOTAL_TIME;
  document.getElementById('g1Result').className='result-msg';
  document.getElementById('g1Btn').textContent = 'â³ Playing...';
  document.getElementById('g1Btn').disabled = true;

  // Pick target
  const shuffled = shuffle(DRESSES);
  g1Target = shuffled[0];
  const options = shuffle(shuffled.slice(0,6)); // show all 6

  // Instruction
  document.getElementById('g1Instruction').innerHTML =
    `Find the <span>${g1Target.label}</span> Dress! Tap the right Dolly! ğŸ¯`;

  // Build grid
  const grid = document.getElementById('bearsGrid');
  grid.innerHTML = '';
  options.forEach(d => {
    const div = document.createElement('div');
    div.className = 'bear-option';
    div.dataset.id = d.id;
    div.innerHTML = makeBearSVG(d.color, d.bowColor) + `<div class="bear-label">${d.label}</div>`;
    div.onclick = () => handleG1Pick(d.id, div);
    grid.appendChild(div);
  });

  // Timer
  updateTimerRing();
  g1Timer = setInterval(() => {
    g1Time--;
    if (g1Time % 3 === 0 && g1Time > 0) playTick();
    updateTimerRing();
    if (g1Time <= 0) {
      clearInterval(g1Timer);
      endGame1(false, null);
    }
  }, 1000);
}

function updateTimerRing() {
  const frac = g1Time / TOTAL_TIME;
  const offset = circumference * (1 - frac);
  const arc = document.getElementById('timerArc');
  arc.style.strokeDashoffset = offset;
  arc.style.stroke = g1Time > 8 ? '#b8b3e9' : g1Time > 4 ? '#ffe66d' : '#ff8888';
  document.getElementById('timerText').textContent = g1Time;
}

function handleG1Pick(id, el) {
  if (!g1Running) return;
  clearInterval(g1Timer);
  g1Running = false;
  const won = id === g1Target.id;
  el.classList.add(won ? 'correct' : 'wrong');
  // disable all
  document.querySelectorAll('.bear-option').forEach(b => b.classList.add('disabled'));
  if (!won) {
    // highlight correct
    document.querySelectorAll('.bear-option').forEach(b => {
      if (b.dataset.id === g1Target.id) b.classList.add('correct');
    });
  }
  setTimeout(() => endGame1(won, el), 500);
}

function endGame1(won, el) {
  g1Running = false;
  const btn = document.getElementById('g1Btn');
  const res = document.getElementById('g1Result');
  if (won) {
    const pts = Math.max(10, g1Time * 8);
    addScore(pts);
    res.className = 'result-msg win';
    res.textContent = `ğŸ‰ Correct! +${pts} points! You found the ${g1Target.label} dress! ğŸ’—`;
    playWin();
    launchConfetti(45);
    showWinOverlay('ğŸ‰ Correct Dolly!', `You found the ${g1Target.label} dress in time! +${pts} points! You are amazing! ğŸ»ğŸ’•`);
  } else {
    playWrong();
    res.className = 'result-msg lose';
    res.textContent = `â° Time's up! The correct dress was ${g1Target.label}. Try again! ğŸ’ª`;
  }
  btn.disabled = false;
  btn.textContent = 'ğŸ”„ Play Again!';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GAME 2  â€“  10-Piece Sliding Puzzle
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 10 bear emojis + 2 empty (4x3 grid = 12 cells, 10 filled, 2 empty)
// Pieces are teddy bears with different dress colors
const PIECES = [
  {emoji:'ğŸ»',label:'1',bg:'#f9b4c4'},
  {emoji:'ğŸ»',label:'2',bg:'#b8b3e9'},
  {emoji:'ğŸ»',label:'3',bg:'#4a90d9'},
  {emoji:'ğŸ»',label:'4',bg:'#ffe66d'},
  {emoji:'ğŸ»',label:'5',bg:'#7ed6a0'},
  {emoji:'ğŸ»',label:'6',bg:'#ffb347'},
  {emoji:'ğŸ»',label:'7',bg:'#f9b4c4'},
  {emoji:'ğŸ»',label:'8',bg:'#b8b3e9'},
  {emoji:'ğŸ»',label:'9',bg:'#4a90d9'},
  {emoji:'ğŸ»',label:'10',bg:'#ffe66d'},
];
// Grid: 4 cols x 3 rows = 12 cells. 10 pieces + 2 empty slots
const COLS = 4, ROWS = 3, TOTAL = COLS * ROWS;
// Solved order: pieces 0-9 fill positions 0-9, positions 10,11 are empty
const SOLVED = [...Array(10).keys(), -1, -1]; // -1 = empty

let puzzleState = []; // array of piece indices (-1 = empty)
let moveCount2 = 0, puzzleTimer2 = null, puzzleTime2 = 0, puzzleSolved2 = false;

function getCellSize() {
  const maxW = Math.min(window.innerWidth - 48, 380 - 36);
  return Math.floor((maxW - (COLS-1)*3 - 6) / COLS);
}

function initPuzzle() {
  clearInterval(puzzleTimer2);
  puzzleTime2 = 0; moveCount2 = 0; puzzleSolved2 = false;
  document.getElementById('moveCount').textContent = 0;
  document.getElementById('puzzleTime').textContent = 0;
  document.getElementById('piecesCorrect').textContent = 0;
  document.getElementById('puzzleSolved').classList.remove('show');

  // Shuffle: start from solved, do random valid moves
  puzzleState = [...SOLVED];
  for(let i=0;i<200;i++) {
    const empties = puzzleState.map((v,i)=>v===-1?i:-1).filter(v=>v!==-1);
    const ei = empties[Math.floor(Math.random()*empties.length)];
    const neighbors = getNeighbors(ei);
    const filled = neighbors.filter(n=>puzzleState[n]!==-1);
    if(filled.length>0){
      const ni = filled[Math.floor(Math.random()*filled.length)];
      [puzzleState[ei], puzzleState[ni]] = [puzzleState[ni], puzzleState[ei]];
    }
  }

  renderPuzzle();

  // Start timer
  puzzleTimer2 = setInterval(()=>{
    if(!puzzleSolved2){
      puzzleTime2++;
      document.getElementById('puzzleTime').textContent = puzzleTime2;
    }
  },1000);
}

function getNeighbors(idx) {
  const r = Math.floor(idx/COLS), c = idx%COLS;
  const n = [];
  if(r>0)      n.push(idx-COLS);
  if(r<ROWS-1) n.push(idx+COLS);
  if(c>0)      n.push(idx-1);
  if(c<COLS-1) n.push(idx+1);
  return n;
}

function renderPuzzle() {
  const cs = getCellSize();
  const grid = document.getElementById('puzzleGrid');
  grid.style.gridTemplateColumns = `repeat(${COLS},${cs}px)`;
  grid.style.gridTemplateRows    = `repeat(${ROWS},${cs}px)`;
  grid.innerHTML = '';

  let correctCount = 0;
  puzzleState.forEach((pieceIdx, cellIdx) => {
    const div = document.createElement('div');
    const isCorrect = pieceIdx === SOLVED[cellIdx];
    if(pieceIdx === -1) {
      div.className = 'puzzle-cell empty';
    } else {
      const isInCorrectPos = (pieceIdx === cellIdx); // piece i belongs at position i
      if(isInCorrectPos) correctCount++;
      div.className = 'puzzle-cell filled' + (isInCorrectPos?' correct-pos':'');
      div.style.background = isInCorrectPos
        ? `linear-gradient(135deg,#f0fff6,#d8f8e0)`
        : `linear-gradient(135deg,${PIECES[pieceIdx].bg}55,white)`;
      div.style.fontSize = cs > 70 ? '1.8rem' : '1.3rem';
      div.innerHTML = PIECES[pieceIdx].emoji +
        `<span class="piece-label">${PIECES[pieceIdx].label}</span>`;
      div.onclick = () => trySlide(cellIdx);
    }
    div.style.width  = cs+'px';
    div.style.height = cs+'px';
    grid.appendChild(div);
  });

  document.getElementById('piecesCorrect').textContent = correctCount;

  // Check solved: all 10 pieces at positions 0-9
  if(!puzzleSolved2) {
    const solved = puzzleState.slice(0,10).every((v,i)=>v===i) &&
                   puzzleState[10]===-1 && puzzleState[11]===-1;
    if(solved) onPuzzleSolved();
  }
}

function trySlide(cellIdx) {
  if(puzzleSolved2) return;
  if(puzzleState[cellIdx]===-1) return; // clicked empty
  const neighbors = getNeighbors(cellIdx);
  const emptyN = neighbors.find(n=>puzzleState[n]===-1);
  if(emptyN===undefined) return; // no adjacent empty
  [puzzleState[cellIdx], puzzleState[emptyN]] = [puzzleState[emptyN], puzzleState[cellIdx]];
  moveCount2++;
  document.getElementById('moveCount').textContent = moveCount2;
  playSlide();
  renderPuzzle();
}

function onPuzzleSolved() {
  puzzleSolved2 = true;
  clearInterval(puzzleTimer2);
  const pts = Math.max(20, 300 - moveCount2*2 - puzzleTime2);
  addScore(pts);
  document.getElementById('puzzleSolved').classList.add('show');
  playPuzzleWin();
  launchConfetti(80);
  setTimeout(()=>{
    showWinOverlay('ğŸ§© Puzzle Solved!',
      `Amazing! You solved the 10-teddy puzzle in ${moveCount2} moves & ${puzzleTime2}s!\n+${pts} points! You are so smart Dolly! ğŸ’—ğŸ»`);
  },600);
}

// â•â• FLOATING HEARTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const HBG = document.getElementById('hbg');
const EMJ = ['ğŸ’™','ğŸ’œ','ğŸ’—','ğŸŒ¸','âœ¨','ğŸ’•','â­','ğŸ€','ğŸ«§'];
for(let i=0;i<24;i++){
  const h=document.createElement('div'); h.className='hf';
  h.textContent=EMJ[Math.floor(Math.random()*EMJ.length)];
  h.style.left=Math.random()*100+'%';
  h.style.fontSize=(11+Math.random()*18)+'px';
  h.style.animationDuration=(6+Math.random()*9)+'s';
  h.style.animationDelay=(Math.random()*9)+'s';
  HBG.appendChild(h);
}

// â•â• INIT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
initPuzzle();
</script>
</body>
</html>
